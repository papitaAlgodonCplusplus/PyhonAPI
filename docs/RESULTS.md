PS C:\Users\AlexQQ\Desktop\PyhonAPI> python fertilizer_calculator_api.py
ADVANCED FERTILIZER CALCULATOR API TESTER v2.0
Testing complete integration with C# algorithm implementation
Features: Advanced optimization, verification, cost analysis, Swagger integration
======================================================================
✅ Advanced Calculator API is running at http://localhost:8000
ADVANCED FERTILIZER CALCULATOR API - COMPREHENSIVE TEST
======================================================================
🕐 Test Started: 2025-07-20 12:35:58

🔄 Test 1/4: API Health Check
------------------------------
🏥 Testing Advanced API Health...
✅ API Status: healthy
📦 Version: 2.0.0
🚀 Available Features:
   • Advanced nutrient optimization
   • Solution verification
   • Ionic balance analysis
   • Cost analysis
   • Swagger API integration
   • Detailed reporting

🔄 Test 2/4: Swagger Integration Test Endpoint
---------------------------------------------
🔗 Testing Swagger Integration Endpoint...
🔗 Integration Test Status: 200
✅ Integration test: integration_test_complete

📡 Swagger API Tests:
   ✅ catalogs: Found 1 catalogs
   ✅ fertilizers: Found 32 fertilizers
   ✅ requirements: Found requirements
   ✅ water_analysis: Found water analysis

🧪 Chemistry Data Tests:
   ✅ Acido Nítrico DAC
   ✅ Acido Fosfórico
   ✅ Acido Sulfurico

🎯 Integration Readiness:
   ✅ Fertilizers Available: True
   ✅ Chemistry Available: True
   ✅ Requirements Available: True
   ✅ Water Available: True
   ✅ Ready For Calculation: True

🔄 Test 3/4: Direct Swagger Integration
-----------------------------------
🔄 Testing Direct Swagger Integration...

📋 Test 1: {'catalog_id': 1, 'phase_id': 1, 'water_id': 1, 'volume_liters': 1000}
🔄 Integration Status: 200
✅ Data Source: Swagger API Integration
📊 Fertilizers Analyzed: 10
⏰ Calculation Time: 2025-07-20T12:36:06.275496
📈 Data Summary:
   • Fertilizers Available: 32
   • Fertilizers With Chemistry: 10
   • Target Parameters: 16
   • Water Parameters: 16
   • Total Dosages: 0
🎯 Calculation Results:
   • Final EC: 0.14 dS/m
   • Final pH: 6.7
   • Ionic Balance: ✅ Balanced
   • Total Cost: $0.00

🔄 Test 4/4: Advanced Calculation Endpoint
----------------------------------------
🧮 Testing Advanced Calculation Endpoint...
🧮 Advanced Calculation Status: 200
✅ Advanced calculation successful!

📊 EXECUTIVE SUMMARY:
==================================================
Final EC: 2.11 dS/m
Final pH: 5.2
Ionic Balance: ❌ Unbalanced (100.0% error)
Total Cost: $4.44
Calculation Success: ✅

💊 FERTILIZER DOSAGES:
  KH2PO4              :   0.274 g/L (  0.274 ml/L)
  Ca(NO3)2.2H2O       :   2.117 g/L (  2.117 ml/L)
  MgSO4.7H2O          :   1.148 g/L (  1.148 ml/L)
  KNO3                :   0.351 g/L (  0.351 ml/L)
  K2SO4               :   0.470 g/L (  0.470 ml/L)
  FeEDTA              :   0.029 g/L (  0.029 ml/L)

🎯 VERIFICATION RESULTS:
  Ca      :   172.0 mg/L (target:   172.0)   +0.0% ✅
  K       :   309.5 mg/L (target:   260.0)  +19.1% ⚠️
  Mg      :    50.0 mg/L (target:    50.0)   +0.0% ✅
  Na      :     9.4 mg/L (target:     9.4)   +0.0% ✅
  NH4     :     0.0 mg/L (target:     0.0)   +0.0% ✅
  N       :   150.0 mg/L (target:   150.0)   +0.0% ✅
  S       :   108.0 mg/L (target:   108.0)   +0.0% ✅
  Cl      :     0.0 mg/L (target:    50.0) +100.0% ❌
  P       :    45.0 mg/L (target:    45.0)   +0.0% ✅
  HCO3    :     0.0 mg/L (target:    30.5) +100.0% ❌
  Fe      :     1.0 mg/L (target:     1.0)   +0.0% ✅
  Mn      :     0.0 mg/L (target:     0.5) +100.0% ❌
  Zn      :     0.0 mg/L (target:     0.2) +100.0% ❌
  Cu      :     0.0 mg/L (target:     0.1) +100.0% ❌
  B       :     0.0 mg/L (target:     0.5) +100.0% ❌
  Mo      :     0.0 mg/L (target:     0.0) +100.0% ❌

⚖️ IONIC RELATIONSHIPS:
  K:Ca Ratio     :   0.92 (target: 0.8-1.5) ✅
  Ca:Mg Ratio    :   2.09 (target: 2.0-4.0) ✅

💰 COST BREAKDOWN:
  KH2PO4              : $ 0.685 ( 15.4%)
  Ca(NO3)2.2H2O       : $ 1.693 ( 38.2%)
  MgSO4.7H2O          : $ 0.689 ( 15.5%)
  KNO3                : $ 0.421 (  9.5%)
  K2SO4               : $ 0.705 ( 15.9%)
  FeEDTA              : $ 0.242 (  5.5%)

💡 OPTIMIZATION SUGGESTIONS:
  • Ca(NO3)2.2H2O represents 38.2% of total cost. Consider alternative sources.
  • Compare prices from multiple suppliers regularly.
  • Consider seasonal purchasing during low demand periods.

⚠️ WARNINGS:
  • ✅ No special safety warnings for this fertilizer combination

📋 COMPREHENSIVE TEST SUMMARY
======================================================================
Health Check                       : ✅ PASSED
Swagger Integration Test           : ✅ PASSED
Direct Swagger Integration         : ✅ PASSED
Advanced Calculation               : ✅ PASSED

Overall Result: 4/4 tests passed
🎉 ALL TESTS PASSED! System is ready for production.

📖 Available Endpoints:
   • API Documentation: http://localhost:8000/docs
   • Health Check: http://localhost:8000/health
   • Advanced Calculation: http://localhost:8000/calculate-advanced
   • Swagger Integration: http://localhost:8000/swagger-integrated-calculation
   • Integration Test: http://localhost:8000/test-swagger-integration

🕐 Test Completed: 2025-07-20 12:36:06

💡 NEXT STEPS:
✅ System is production-ready!
   • Deploy to production environment
   • Set up monitoring and logging
   • Configure backup authentication tokens
   • Test with real crop data
PS C:\Users\AlexQQ\Desktop\PyhonAPI> 